<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="order.css">
    <link rel="stylesheet" href="fontawesome/css/all.min.css">
    <title>Đặt hàng</title>
</head>
<body>
    <div class="container">
        <div id="logo">
            <img src="./Images/logo.png" alt="">
            <span>BAOANH Sneakers</span>
           <nav>
            <a href="./myweb.html">Home</a>
            <a href="">Shop</a>
            <a href="">About</a>
            <a href=""> <i class="fa-solid fa-basket-shopping"></i></a> 
           </nav>
        </div>
        <div class="notifications">
           
        </div>
        <h2>Đặt mua sản phẩm</h2>
        <div class="infomation">
            <div id="order-details">
                <img id="product-image" src="" alt="Hình ảnh sản phẩm" style="max-width: 320px; height: auto;">
                <p>Giới tính: <span id="product-cat"></span></p>
                <p>Tên sản phẩm: <span id="product-name"></span></p>
                <p>Giá: <span id="product-price">VND</span></p>
            </div>    
            <div class="size">
                <p>Size</p>
                <select name="comboBox" id="comboBox">
                    <option value="37">37</option>
                    <option value="38">38</option>
                    <option value="39">39</option>
                    <option value="40">40</option>
                    <option value="41">41</option>
                    <option value="42">42</option>
                    <option value="43">43</option>
                </select>
            </div>
            <div class="quantity">
                <p>Quantity</p>
                <div id="buy-amount">
                    <button class="minus-btn" onclick="handleMinus(),updateTotalPrice()"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="size-6">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M5 12h14" />
                      </svg>                  
                      </button>
                    <input type="text" id="amount" name="amount" value="1">
                    <button class="plus-btn" onclick="handlePlus(),updateTotalPrice()"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="size-6">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M12 4.5v15m7.5-7.5h-15" />
                      </svg>
                      </button>
                </div>
            </div>
            <div class="total">
                <p>Total</p>
                <div class="total-price">
                    <span id="total-price"></span> 
                    <span style="color: red; font-weight: bold; font-size: 20px;">VND</span>
                </div>
            </div>
            <div class="ok">
                <button id="success" type="submit">Order</button>
            </div>
        </div>
    </div>


    <script>
       
        function getQueryParams() {
            const params = new URLSearchParams(window.location.search);
            return {
                cat:   params.get('cat'),
                name:  params.get('name'),
                price: params.get('price'),
                image: params.get('image')
            };
        }

        const productInfo = getQueryParams();
        
        if (productInfo.cat && productInfo.name && productInfo.price && productInfo.image) {
            document.getElementById('product-cat').textContent=productInfo.cat;
            document.getElementById('product-name').textContent = productInfo.name;
            document.getElementById('product-price').textContent = productInfo.price;
            document.getElementById('product-image').src = decodeURIComponent(productInfo.image);
            document.getElementById('product-image').alt = productInfo.name;
        } else {
            document.getElementById('order-details').textContent = 'Không có thông tin sản phẩm để hiển thị.';
        }


        let amountElement = document.getElementById("amount");
        let amount = amountElement.value;
        let render = (amount)=>{
            amountElement.value=amount;
        }
        let handlePlus = () => {
            amount++;
            render(amount);
        }
        let handleMinus = () => {
            if(amount>1)
            amount--;
            render(amount);
        }
        // function render(amout){
        //     amountElement.value=amount
        // }
        // function handlePlus(){
        //     amount++
        //     console.log(amount)
        //     render(amount)
        // }
        // function handleMinus(){
        //     if(amount>1)
        //     amount--
        //     render(amount)
        // }
        amountElement.addEventListener('input',()=>{
            amount=amountElement.value;
            amount=parseInt(amount);
            amount=(isNaN(amount)||amount==0)?1:amount;
            render(amount);

        })
        function formatNumber(value) {
            return value.toLocaleString('vi-VN');
        }

        document.addEventListener('DOMContentLoaded', function() {
            var priceElements = document.querySelectorAll('.product-price');
            priceElements.forEach(function(priceElement) {
                var price = parseInt(priceElement.textContent);
                priceElement.textContent = formatNumber(price);
            });
        });
        function formatCurrency(value) {
            return value.toLocaleString('vi-VN', { style: 'currency', currency: 'VND' }).replace("₫", "VND");
        }

        document.addEventListener('DOMContentLoaded', function() {
            var priceElement = document.getElementById('product-price');
            var price = parseInt(priceElement.textContent);
            priceElement.textContent = formatCurrency(price);
        });
        const priceElement = document.getElementById('product-price');
        const totalPriceElement = document.getElementById('total-price');
        function updateTotalPrice() {
            var price = parseInt(productInfo.price);
            var quantity = parseInt(amountElement.value);
            var totalPrice = price * quantity;
            totalPriceElement.textContent = formatNumber(totalPrice);
        }
        document.addEventListener('DOMContentLoaded', function() {
            updateTotalPrice();
            priceElement.textContent = formatNumber(parseInt(productInfo.price));
        });
        let notifications =document.querySelector('.notifications')
        let success=document.getElementById('success')
        function createToast(type,icon,title,text){
            let newToast =document.createElement('div')
            newToast.innerHTML=`
            <div class="toast ${type}">
                <i class="${icon}"></i>
                <div class="content">
                    <div class="title">${title}</div>
                    <span>${text}</span>
                </div>
            </div>`;
            notifications.appendChild(newToast);
            newToast.timeOut=setTimeout(()=>newToast.remove(),5000)
        }
        success.onclick=function(){
            let type='success'
            let icon='fa-regular fa-circle-check'
            let title='Success'
            let text='Congratulations on your successful order.'
            createToast(type,icon,title,text)
        }
    </script>
</body>
</html>